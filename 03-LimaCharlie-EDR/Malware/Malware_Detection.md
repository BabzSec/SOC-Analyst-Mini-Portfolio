# ü¶† Malware Detection & Analysis

This document showcases the malware detection and analysis workflow performed in a **safe, isolated Windows VM** using **LimaCharlie EDR** and other tools.  

It demonstrates how professional malware can evade traditional defenses like Windows Defender and the importance of deep inspection for accurate threat detection.

---

## 1Ô∏è‚É£ LimaCharlie Detection

The first step was detecting suspicious activity using **LimaCharlie**. The agent flagged unusual behavior and alerted on potentially malicious files.

- **Key Findings:**  
  - Multiple detections for suspicious files in the directory:  
    `C:\Users\VMSP\AppData\Roaming\Microsoft\SystemCertificates\`  
  - Example event: `2025-09-21 18:58:18 ‚Äì Regsvr32 Execution From Potential Suspicious Location`  

- **Analysis Insight:**  
  LimaCharlie detected the malicious files even when Windows Defender missed them, highlighting the importance of endpoint detection platforms for professional SOC work.

- **Screenshot:**  
![LimaCharlie Detection](../04-Screenshots/LimaCharlie/Alerts/Malware/01-LimaCharlie_Detection.png)

---

## 2Ô∏è‚É£ VirusTotal Hash Verification

After identifying the suspicious file, the hash was checked on **VirusTotal**.

- **Observation:**  
  - The hash pointed to `REGSVR32.EXE`, not the actual malicious file.  
  - No detections on VirusTotal, illustrating how advanced malware can hide behind legitimate Windows binaries to bypass traditional detection.

- **Analysis Insight:**  
  - Professional malware often leverages system processes (like `REGSVR32.EXE`) to hide its payload.  
  - Manual investigation and endpoint monitoring are crucial to uncover the true threat.

- **Screenshot:**  
![VirusTotal Detection](../04-Screenshots/LimaCharlie/Alerts/Malware/02-VirusTotal_Detection.png)

---

## 3Ô∏è‚É£ Malware Scanning (Windows Defender)

A manual scan was performed using **Windows Defender** on the identified suspicious files:

- File paths:  
  - `C:\Users\VMSP\AppData\Roaming\Microsoft\SystemCertificates\bJYD_bJYD9_bJY_v1.dll`  
  - `C:\Users\VMSP\AppData\Roaming\Microsoft\SystemCertificates\f116a6c2.exe`  

- **Observation:**  
  - Windows Defender did not detect either file.  
  - This confirms the malware‚Äôs ability to evade traditional antivirus solutions.

- **Screenshot:**  
![Malware Scanned with Windows Defender](../04-Screenshots/LimaCharlie/Alerts/Malware/03-Malware_Scanned_WinDefender.png)

---

## 4Ô∏è‚É£ Deep Dive ‚Äì DLL File Analysis

The DLL file was analyzed to inspect its properties, signatures, and metadata.

- **Key Findings:**  
  - **File Version:** `0.0.0.0` ‚Üí red flag  
  - **File Description & Product Name:** `Immersive TPM Virtual Smart Card Reader Manager COM` ‚Üí suspicious for this directory  
  - **Digital Signature:** Invalid (from 2020)  
  - **File Name:** `bJYD_bJYD9_bJY_v1.dll` ‚Üí obfuscated naming pattern  

- **Analysis Insight:**  
  - DLL properties and invalid digital signatures are strong indicators of malicious intent.  
  - Metadata inconsistencies helped confirm this as a threat despite evasions.

- **Screenshot:**  
![DLL File Analysis](../04-Screenshots/LimaCharlie/Alerts/Malware/04-DLL_File_Analysis.png)

---

## 5Ô∏è‚É£ Deep Dive ‚Äì EXE File Analysis

The EXE file was analyzed for metadata, language, and other red flags.

- **Key Findings:**  
  - **File Size:** 177 KB ‚Üí small, typical for malware droppers 
  - **File Description:** Missing ‚Üí suspicious  
  - **Product Name:** Missing ‚Üí suspicious  
  - **Copyright:** Missing  
  - **File Type:** Application (normal)  
  - **File Version:** `1.0.1.1046` ‚Üí could be normal
  - **Language:** Chinese (Simplified, China) ‚Üí unusual in this context  

- **Analysis Insight:**  
  - Despite some normal properties, missing metadata fields and unusual language indicate malicious behavior.  
  - This deep-dive analysis complements EDR alerts to provide a comprehensive threat picture.

- **Screenshot:**  
![EXE File Analysis](../04-Screenshots/LimaCharlie/Alerts/Malware/05-Exe_File_Analysis.png)

---

## üí° Portfolio Tips

- Highlight **why each file is suspicious** ‚Äî metadata inconsistencies, invalid signatures, or unusual execution patterns.  
- Show the **workflow**: detection ‚Üí VirusTotal verification ‚Üí malware scanning ‚Üí deep dive analysis.  
- Emphasize **EDR capabilities** over traditional antivirus when demonstrating advanced threats.  
- Always perform tests in a **safe, isolated lab** and indicate clearly in the portfolio that files are tested securely.  
- Include **timestamps, paths, and detection events** for professional documentation.

---
